<script src="/static/js/topmenu.js"></script>
<div class="ui fixed transparent inverted main menu">
	<div class="container">
		<a class="launch item"><i class="icon list layout"></i> Content</a>

		<a class="active item" href="/">
			<i class="home icon"></i> <?=_('Home')?>
		</a>
		<? if lwf.ctx.user then
		if devlist and #devlist ~= 0 then ?>
		<div class="ui dropdown item">
			<i class="folder icon"></i> <?=_('Devices')?>
			<div class="menu">
				<a class="item" href="/user/keys">
					<i class="cloud upload icon"></i> <?=_("Add Keys")?>
				</a>
				<? for k, v in pairs(devlist) do
					local path = '/devices/'..v.key
					?>
					<a class="item" href="<?=path ?>">
						<? if v.online then ?>
						<i class="leaf green icon"></i> <?=v.name or v.key ?>
						<? else ?>
						<i class="leaf red icon"></i> <?=v.name or v.key ?>
						<? end ?>
					</a>
				<? end ?>
			</div>
		</div>
		<? else ?>
		<a class="item" href="/#/devices">
			<i class="cloud upload icon"></i> <?=_("Devices")?>
		</a>
		<? end
		end?>
		<? if lwf.ctx.user then
		if applist and #applist ~= 0 then ?>
		<div class="ui dropdown item">
			<i class="folder icon"></i> <?=_('My Apps')?>
			<div class="menu">
				<a class="item" href="/app/new">
					<i class="cloud upload icon"></i> <?=_("New App")?>
				</a>
				<? for k, v in pairs(applist) do
					local path = '/app/detail/'..v.info.path
					?>
					<a class="item" href="<?=path ?>">
						<i class="leaf icon"></i> <?=v.name ?>
					</a>
				<? end ?>
			</div>
		</div>
		<? else ?>
		<a class="item" href="/app/new">
			<i class="cloud upload icon"></i> <?=_("New App")?>
		</a>
		<? end
		end?>
		<div class="right menu">
			<? if lwf.ctx.user then ?>
			<div class="item">
				<div class="ui icon input">
					<input placeholder="Search..." type="text">
					<i class="search link icon"></i>
				</div>
			</div>
			<? end ?>
			<div class="ui dropdown item">
				<i class="icon globe"></i>
				<div class="menu">
					<a class="item" href="/lang/en">English</a>
					<a class="item" href="/lang/zh">中文</a>
				</div>
			</div>
			<? if not lwf.ctx.user then ?>
			<div class="item">
				<a class="ui teal button" href="/user/login"><i class="sign in icon"></i><?=_("Sign In")?></a>
			</div>
			<? else ?>
			<div class="ui dropdown item">
				<i class="icon tint"></i> <?=lwf.ctx.user.username ?>
				<div class="ui label">25</div>
				<div class="menu">
					<a class="item" href="/msg">
						<i class="mail icon"></i> <?=_("Messages")?>
						<div class="ui label">25</div>
					</a>

					<a class="item" href="/user/profile"><i class="edit icon"></i> <?=_("Edit Profile")?></a>
					<a class="item" href="/user/devkeys"><i class="key icon"></i> <?=_("Device Keys")?></a>
					<a class="item" href="/user/logout"><i class="sign out icon"></i> <?=_("Logout")?></a>
				</div>
			</div>
			<? end ?>

		</div>
	</div>
</div>
